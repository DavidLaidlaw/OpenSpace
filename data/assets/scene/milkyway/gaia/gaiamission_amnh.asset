local assetHelper = asset.require("util/asset_helper")

local textures = asset.syncedResource({
    Name = "Stars Textures",
    Type = "HttpSynchronization",
    Identifier = "stars_textures",
    Version = 1
})

local colorLUT = asset.syncedResource({
    Name = "Stars Color Table",
    Type = "HttpSynchronization",
    Identifier = "stars_colormap",
    Version = 1
})

-- Download a preprocessed binary octree of Radial Velocity subset values per star (preprocessed into 8 binary files).
-- local torrentStars = asset.syncedResource({
--     Name = "Gaia DR2 RV Octree",
--     Type = "TorrentSynchronization",
--     Identifier = "gaia_stars",
--     Magnet = "magnet:?xt=urn:btih:a9baaeda82673a46b737b86b1cb419d345331caf&dn=DR2_rv_Octree[10kSPN,20dist]"
-- })

local localStars = "F:/Gaia"

local GaiaMission = {
    Identifier = "GaiaMission",
    Renderable = {
        Type = "RenderableGaiaStars",
        -- Enabled = false,
        -- File = localStars .. "/DR2_rv_Octree[10kSPN,20dist]/",
        File = localStars .. "/DR2_rv_Octree[10kSPN,20dist]_5p/",
        -- File = localStars .. "/DR2_full_Octree[20kSPN,200dist]_90,0/",
        -- File = localStars .. "/DR2_full_Octree[50kSPN,250dist]_50,125/",
        -- File = localStars .. "/DR2_full_Octree[50kSPN,250dist]_200pc,50/",
        -- File = localStars .. "/DR2_full_Octree[50kSPN,500dist]_50,50/",
        -- File = localStars .. "/DR2_full_Octree[75kSPN,800dist]_5p/", -- 915M
        FileReaderOption = "StreamOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 35,
        MagnitudeBoost = 25,
        CutOffThreshold = 38,
        BillboardSize = 10,
        CloseUpBoostDist = 300,
        Sharpness = 1.45,
        LodPixelThreshold = 0,
        MaxGpuMemoryPercent = 0.24,
        MaxCpuMemoryPercent = 0.4,
        FilterSize = 4,
        Sigma = 0.2,
        AdditionalNodes = {3.0, 2.0},
        FilterPosX = {0.0, 0.0},
        FilterPosY = {0.0, 0.0},
        FilterPosZ = {0.0, 0.0},
        FilterGMag = {20.0, 20.0},
        FilterBpRp = {0.0, 0.0},
        FilterDist = {9.0, 9.0},
    },
    GUI = {
        Name = "Gaia Mission",
        Path = "/GaiaMission"
    }
}

local GaiaMissionTGAS = {
    Identifier = "GaiaMissionTGAS",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_DR1_Octree_10kSPN.bin",
        --File = localStars .. "/TGAS_Octree_10kSPN.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "Gaia Mission TGAS",
        Path = "/GaiaMission"
    }
}

-- Subsets for the Gaia event at AMNH 4 June 2018.
local AMNH_andromeda = {
    Identifier = "AMNH_andromeda",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/andromeda_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH Andromeda",
        Path = "/GaiaMission"
    }
}

local AMNH_apogee = {
    Identifier = "AMNH_apogee",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/apogee_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH Apogee",
        Path = "/GaiaMission"
    }
}

local AMNH_cepheids = {
    Identifier = "AMNH_cepheids",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/GaiaCepheids_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH Cepheids",
        Path = "/GaiaMission"
    }
}

local AMNH_coMovingAll = {
    Identifier = "AMNH_coMovingAll",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/GaiaCoMovingStarsAll_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH Co-moving All",
        Path = "/GaiaMission"
    }
}

local AMNH_coMovingVel = {
    Identifier = "AMNH_coMovingVel",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/GaiaCoMovingStarsVel_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH Co-moving Vel",
        Path = "/GaiaMission"
    }
}

local AMNH_giantsG14 = {
    Identifier = "AMNH_giantsG14",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/DR2_giants_G14_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH Giants G14",
        Path = "/GaiaMission"
    }
}

local AMNH_giants = {
    Identifier = "AMNH_giants",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/DR2_giants_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH Giants",
        Path = "/GaiaMission"
    }
}

local AMNH_UMS = {
    Identifier = "AMNH_UMS",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/GaiaUMS_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH UMS",
        Path = "/GaiaMission"
    }
}

local AMNH_groupMembers = {
    Identifier = "AMNH_groupMembers",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/GaiaGroupMembers.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH Group Members",
        Path = "/GaiaMission"
    }
}

local AMNH_galah = {
    Identifier = "AMNH_galah",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/galah_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH Galah",
        Path = "/GaiaMission"
    }
}

local AMNH_hypatia = {
    Identifier = "AMNH_hypatia",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/hypatiaOverlap_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH Hypatia",
        Path = "/GaiaMission"
    }
}

local AMNH_k2 = {
    Identifier = "AMNH_k2",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/GaiaK2_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Static",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH K2",
        Path = "/GaiaMission"
    }
}

local AMNH_kepler = {
    Identifier = "AMNH_kepler",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/GaiaKepler_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH Kepler",
        Path = "/GaiaMission"
    }
}

local AMNH_keplerPlanets = {
    Identifier = "AMNH_keplerPlanets",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/GaiaKeplerPlanets_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH Kepler Planets",
        Path = "/GaiaMission"
    }
}

local AMNH_RRLyn = {
    Identifier = "AMNH_RRLyn",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/GaiaRRLyr_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH RR Lyn",
        Path = "/GaiaMission"
    }
}

local AMNH_LongPerVar = {
    Identifier = "AMNH_LongPerVar",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_event_Octree_files/GaiaLongPerVar_Octree.bin",
        FileReaderOption = "BinaryOctree", -- BinaryOctree, StreamOctree
        RenderOption = "Color",
        ShaderOption = "Point_SSBO",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "AMNH LongPerVar",
        Path = "/GaiaMission"
    }
}

-- Prepared asset from Vienna's DR1_TGAS file (2.1M stars) if user want to compare the datasets.
local GaiaMissionFits = {
    Identifier = "GaiaMissionFits",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/TGAS_Octree_10kSPN.bin",
        FileReaderOption = "BinaryOctree",
        ColumnOption = "Static",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "Gaia Mission Fits",
        Path = "/GaiaMission"
    }
}

-- Prepared asset from AMNH (DR1 subset + HIP) if user want to compare the datasets.
local GaiaMissionSpeck = {
    Identifier = "GaiaMissionSpeck",
    Renderable = {
        Type = "RenderableGaiaStars",
        Enabled = false,
        File = localStars .. "/AMNH_DR1_Octree_10kSPN.bin",
        FileReaderOption = "BinaryOctree",
        ColumnOption = "Color",
        Texture = textures .. "/halo.png",
        ColorMap = colorLUT .. "/colorbv.cmap",
        LuminosityMultiplier = 200,
        LodPixelThreshold = 0,
        FilterSize = 3,
        Sigma = 0.2,
    },
    GUI = {
        Name = "Gaia Mission Speck",
        Path = "/GaiaMission"
    }
}

-- assetHelper.registerSceneGraphNodesAndExport(asset, { GaiaMission })
-- assetHelper.registerSceneGraphNodesAndExport(asset, { GaiaMissionFits, GaiaMissionSpeck })

assetHelper.registerSceneGraphNodesAndExport(asset, { 
    GaiaMissionTGAS
    , GaiaMissionSpeck
    , AMNH_andromeda
    -- , AMNH_apogee
    , AMNH_cepheids
    , AMNH_coMovingAll
    , AMNH_coMovingVel
    , AMNH_giantsG14
    , AMNH_giants
    , AMNH_UMS
    , AMNH_groupMembers
    -- , AMNH_galah
    -- , AMNH_hypatia
    , AMNH_k2
    , AMNH_kepler
    , AMNH_keplerPlanets
    , AMNH_RRLyn
    , AMNH_LongPerVar
    , GaiaMission
})

